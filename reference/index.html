
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the pyclugen cluster generation toolbox">
      
      
        <meta name="author" content="Nuno Fachada">
      
      
        <link rel="canonical" href="https://clugen.github.io/pyclugen/reference/">
      
      
        <link rel="prev" href="../generated/gallery/plot_functions/">
      
      
        <link rel="next" href="../dev/">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/clugen/.github/main/logos/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Reference - pyclugen documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../sg_gallery-dataframe.css">
    
      <link rel="stylesheet" href="../sg_gallery-binder.css">
    
      <link rel="stylesheet" href="../sg_gallery-rendered-html.css">
    
      <link rel="stylesheet" href="../sg_gallery.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyclugen.Clusters" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyclugen documentation" class="md-header__button md-logo" aria-label="pyclugen documentation" data-md-component="logo">
      
  <img src="https://github.com/clugen/.github/blob/main/logos/apple-touch-icon-120x120.png?raw=true" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyclugen documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/clugen/pyclugen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../theory/" class="md-tabs__link">
        
  
    
  
  Theory

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../generated/gallery/" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../dev/" class="md-tabs__link">
        
  
    
  
  Development

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyclugen documentation" class="md-nav__button md-logo" aria-label="pyclugen documentation" data-md-component="logo">
      
  <img src="https://github.com/clugen/.github/blob/main/logos/apple-touch-icon-120x120.png?raw=true" alt="logo">

    </a>
    pyclugen documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/clugen/pyclugen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theory
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../generated/gallery/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_1_1d_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples in 1D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_2_2d_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples in 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_3_3d_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples in 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_4_nd_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples in nD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_5_mrg_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merging and hierarchical cluster examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/gallery/plot_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyclugen.Clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Clusters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.angle_btw" class="md-nav__link">
    <span class="md-ellipsis">
      angle_btw
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.angle_deltas" class="md-nav__link">
    <span class="md-ellipsis">
      angle_deltas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clucenters" class="md-nav__link">
    <span class="md-ellipsis">
      clucenters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clugen" class="md-nav__link">
    <span class="md-ellipsis">
      clugen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clumerge" class="md-nav__link">
    <span class="md-ellipsis">
      clumerge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clupoints_n" class="md-nav__link">
    <span class="md-ellipsis">
      clupoints_n
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clupoints_n_1" class="md-nav__link">
    <span class="md-ellipsis">
      clupoints_n_1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clupoints_n_1_template" class="md-nav__link">
    <span class="md-ellipsis">
      clupoints_n_1_template
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.clusizes" class="md-nav__link">
    <span class="md-ellipsis">
      clusizes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.fix_empty" class="md-nav__link">
    <span class="md-ellipsis">
      fix_empty
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.fix_num_points" class="md-nav__link">
    <span class="md-ellipsis">
      fix_num_points
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.llengths" class="md-nav__link">
    <span class="md-ellipsis">
      llengths
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.points_on_line" class="md-nav__link">
    <span class="md-ellipsis">
      points_on_line
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.rand_ortho_vector" class="md-nav__link">
    <span class="md-ellipsis">
      rand_ortho_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.rand_unit_vector" class="md-nav__link">
    <span class="md-ellipsis">
      rand_unit_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyclugen.rand_vector_at_angle" class="md-nav__link">
    <span class="md-ellipsis">
      rand_vector_at_angle
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Reference</h1>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

      <p>Various functions for multidimensional cluster generation in Python.</p>
<p>Note that:</p>
<ol>
<li><a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> is the main function of the <strong>pyclugen</strong>
   package, and possibly the only function most users will need.</li>
<li>Functions which accept <code>rng</code> as the last parameter are stochastic. Thus, in
   order to obtain the same result on separate invocations of these functions,
   pass them an instance of same pseudo-random number
   <a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator"><code>Generator</code></a> initialized with the same seed.</li>
</ol>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pyclugen.Clusters" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Clusters</span>


<a href="#pyclugen.Clusters" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.NamedTuple" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple">NamedTuple</a></code></p>


      <p>Read-only container for results returned by <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a>.</p>
<p>The symbols presented in the instances variable below have the following
meanings:</p>
<ul>
<li><span class="arithmatex">\(n\)</span> : Number of dimensions.</li>
<li><span class="arithmatex">\(p\)</span> : Number of points.</li>
<li><span class="arithmatex">\(c\)</span> : Number of clusters.</li>
</ul>

              <details class="quote">
                <summary>Source code in <code>pyclugen/main.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">class</span> <span class="nc">Clusters</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Read-only container for results returned by [`clugen()`][pyclugen.main.clugen].</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    The symbols presented in the instances variable below have the following</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    meanings:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    - $n$ : Number of dimensions.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    - $p$ : Number of points.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    - $c$ : Number of clusters.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">points</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;$p \times n$ matrix containing the generated points for all clusters.&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">clusters</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Vector of size $p$ indicating the cluster each point in `points`</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    belongs to.&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">projections</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;$p \times n$ matrix with the point projections on the cluster-supporting</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    lines.&quot;&quot;&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">sizes</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Vector of size $c$ with the number of points in each cluster.&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">centers</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;$c \times n$ matrix with the coordinates of the cluster centers.&quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">directions</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;$c \times n$ matrix with the direction of each cluster-supporting line.&quot;&quot;&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">angles</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Vector of size $c$ with the angles between the cluster-supporting lines and</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    the main direction.&quot;&quot;&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">lengths</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Vector of size $c$ with the lengths of the cluster-supporting lines.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.angles" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">angles</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.angles" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">angles</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Vector of size <span class="arithmatex">\(c\)</span> with the angles between the cluster-supporting lines and
the main direction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.centers" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">centers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.centers" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">centers</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p><span class="arithmatex">\(c \times n\)</span> matrix with the coordinates of the cluster centers.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.clusters" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">clusters</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.clusters" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">clusters</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Vector of size <span class="arithmatex">\(p\)</span> indicating the cluster each point in <code>points</code>
belongs to.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.directions" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">directions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.directions" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">directions</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p><span class="arithmatex">\(c \times n\)</span> matrix with the direction of each cluster-supporting line.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.lengths" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">lengths</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.lengths" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">lengths</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Vector of size <span class="arithmatex">\(c\)</span> with the lengths of the cluster-supporting lines.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.points" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">points</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.points" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">points</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p><span class="arithmatex">\(p \times n\)</span> matrix containing the generated points for all clusters.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.projections" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">projections</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.projections" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">projections</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p><span class="arithmatex">\(p \times n\)</span> matrix with the point projections on the cluster-supporting
lines.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pyclugen.Clusters.sizes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sizes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pyclugen.Clusters.sizes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sizes</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Vector of size <span class="arithmatex">\(c\)</span> with the number of points in each cluster.</p>
    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pyclugen.angle_btw" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">angle_btw</span>


<a href="#pyclugen.angle_btw" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">angle_btw</span><span class="p">(</span><span class="n">v1</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">v2</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Angle between two <span class="arithmatex">\(n\)</span>-dimensional vectors.</p>
<p>Typically, the angle between two vectors <code>v1</code> and <code>v2</code> can be obtained with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
</code></pre></div>
<p>However, this approach is numerically unstable. The version provided here is
numerically stable and based on the
<a href="https://github.com/JeffreySarnoff/AngleBetweenVectors.jl">AngleBetweenVectors</a>
Julia package by Jeffrey Sarnoff (MIT license), implementing an algorithm
provided by Prof. W. Kahan in
<a href="https://people.eecs.berkeley.edu/~wkahan/MathH110/Cross.pdf">these notes</a>
(see page 15).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">degrees</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">angle_btw</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">degrees</span><span class="p">(</span><span class="n">angle_btw</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">60.00000000000001</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>v1</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First vector.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>v2</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second vector.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Angle between <code>v1</code> and <code>v2</code> in radians.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span> <span class="nf">angle_btw</span><span class="p">(</span><span class="n">v1</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">v2</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Angle between two $n$-dimensional vectors.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Typically, the angle between two vectors `v1` and `v2` can be obtained with:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    arccos(dot(u, v) / (norm(u) * norm(v)))</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    ```</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    However, this approach is numerically unstable. The version provided here is</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    numerically stable and based on the</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    [AngleBetweenVectors](https://github.com/JeffreySarnoff/AngleBetweenVectors.jl)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Julia package by Jeffrey Sarnoff (MIT license), implementing an algorithm</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    provided by Prof. W. Kahan in</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    [these notes](https://people.eecs.berkeley.edu/~wkahan/MathH110/Cross.pdf)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    (see page 15).</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        &gt;&gt;&gt; from numpy import array, degrees</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import angle_btw</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        &gt;&gt;&gt; v1 = array([1.0, 1.0, 1.0, 1.0])</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        &gt;&gt;&gt; v2 = array([1.0, 0.0, 0.0, 0.0])</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        &gt;&gt;&gt; degrees(angle_btw(v1, v2))</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        60.00000000000001</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">      v1: First vector.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">      v2: Second vector.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">      Angle between `v1` and `v2` in radians.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">u1</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">u2</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">u1</span> <span class="o">-</span> <span class="n">u2</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">u1</span> <span class="o">+</span> <span class="n">u2</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">arctan</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.angle_deltas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">angle_deltas</span>


<a href="#pyclugen.angle_deltas" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">angle_deltas</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">angle_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get angles between average cluster direction and cluster-supporting lines.</p>
<p>Determine the angles between the average cluster direction and the
cluster-supporting lines. These angles are obtained from a wrapped normal
distribution ( <span class="arithmatex">\(\mu=0\)</span>, <span class="arithmatex">\(\sigma=\)</span><code>angle_disp</code>) with support in the interval
<span class="arithmatex">\(\left[-\pi/2,\pi/2\right]\)</span>. Note this is different from the standard
wrapped normal distribution, the support of which is given by the interval
<span class="arithmatex">\(\left[-\pi,\pi\right]\)</span>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">angle_deltas</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">pi</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">a_rad</span> <span class="o">=</span> <span class="n">angle_deltas</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span> <span class="c1"># Angle dispersion of 22.5 degrees</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">a_rad</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">array([-0.38842705, -0.14442948,  0.50576707,  0.07617358])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">degrees</span><span class="p">(</span><span class="n">a_rad</span><span class="p">)</span> <span class="c1"># Show angle deltas in degrees</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">array([-22.25523038,  -8.27519966,  28.97831838,   4.36442443])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_clusters</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>angle_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Angle dispersion, in radians.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Angles between the average cluster direction and the cluster-supporting
lines, given in radians in the interval <span class="arithmatex">\(\left[-\pi/2,\pi/2\right]\)</span>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span> <span class="nf">angle_deltas</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">angle_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get angles between average cluster direction and cluster-supporting lines.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Determine the angles between the average cluster direction and the</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    cluster-supporting lines. These angles are obtained from a wrapped normal</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    distribution ( $\mu=0$, $\sigma=$`angle_disp`) with support in the interval</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    $\left[-\pi/2,\pi/2\right]$. Note this is different from the standard</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    wrapped normal distribution, the support of which is given by the interval</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    $\left[-\pi,\pi\right]$.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import angle_deltas</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        &gt;&gt;&gt; from numpy import degrees, pi</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(PCG64(123))</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        &gt;&gt;&gt; a_rad = angle_deltas(4, pi/8, rng=prng) # Angle dispersion of 22.5 degrees</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        &gt;&gt;&gt; a_rad</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        array([-0.38842705, -0.14442948,  0.50576707,  0.07617358])</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        &gt;&gt;&gt; degrees(a_rad) # Show angle deltas in degrees</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        array([-22.25523038,  -8.27519966,  28.97831838,   4.36442443])</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">      num_clusters: Number of clusters.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">      angle_disp: Angle dispersion, in radians.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">      Angles between the average cluster direction and the cluster-supporting</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        lines, given in radians in the interval $\left[-\pi/2,\pi/2\right]$.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="c1"># Get random angle differences using the normal distribution</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">angles</span> <span class="o">=</span> <span class="n">angle_disp</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># Reduce angle differences to the interval [-π, π]</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">angles</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">))</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># Make sure angle differences are within interval [-π/2, π/2]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span> <span class="o">-</span> <span class="n">sign</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clucenters" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clucenters</span>


<a href="#pyclugen.clucenters" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clucenters</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">clu_sep</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">clu_offset</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Determine cluster centers using the uniform distribution.</p>
<p>The number of clusters (<code>num_clusters</code>) and the average cluster separation
(<code>clu_sep</code>) are taken into account.</p>
<p>More specifically, let <span class="arithmatex">\(c=\)</span><code>num_clusters</code>, <span class="arithmatex">\(\mathbf{s}=\)</span><code>clu_sep.reshape(-1,1)</code>,
<span class="arithmatex">\(\mathbf{o}=\)</span><code>clu_offset.reshape(-1,1)</code>, <span class="arithmatex">\(n=\)</span><code>clu_sep.size</code> (i.e., number of
dimensions). Cluster centers are obtained according to the following equation:</p>
<div class="arithmatex">\[
\mathbf{C}=c\mathbf{U} \cdot \operatorname{diag}(\mathbf{s}) +
    \mathbf{1}\,\mathbf{o}^T
\]</div>
<p>where <span class="arithmatex">\(\mathbf{C}\)</span> is the <span class="arithmatex">\(c \times n\)</span> matrix of cluster centers,
<span class="arithmatex">\(\mathbf{U}\)</span> is an <span class="arithmatex">\(c \times n\)</span> matrix of random values drawn from the
uniform distribution between -0.5 and 0.5, and <span class="arithmatex">\(\mathbf{1}\)</span> is an <span class="arithmatex">\(c \times
1\)</span> vector with all entries equal to 1.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clucenters</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clucenters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">]),</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">array([[-33.58833231,  36.61463056],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">       [-75.16761145,  40.53115432],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">       [-79.1684689 ,  59.3628352 ]])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_clusters</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_sep</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average cluster separation ( <span class="arithmatex">\(n \times 1\)</span> vector).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_offset</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cluster offsets ( <span class="arithmatex">\(n \times 1\)</span> vector).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <span class="arithmatex">\(c \times n\)</span> matrix containing the cluster centers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span> <span class="nf">clucenters</span><span class="p">(</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">clu_sep</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">clu_offset</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine cluster centers using the uniform distribution.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    The number of clusters (`num_clusters`) and the average cluster separation</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    (`clu_sep`) are taken into account.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    More specifically, let $c=$`num_clusters`, $\mathbf{s}=$`clu_sep.reshape(-1,1)`,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    $\mathbf{o}=$`clu_offset.reshape(-1,1)`, $n=$`clu_sep.size` (i.e., number of</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    dimensions). Cluster centers are obtained according to the following equation:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    $$</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    \mathbf{C}=c\mathbf{U} \cdot \operatorname{diag}(\mathbf{s}) +</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        \mathbf{1}\,\mathbf{o}^T</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    $$</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    where $\mathbf{C}$ is the $c \times n$ matrix of cluster centers,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    $\mathbf{U}$ is an $c \times n$ matrix of random values drawn from the</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    uniform distribution between -0.5 and 0.5, and $\mathbf{1}$ is an $c \times</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    1$ vector with all entries equal to 1.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clucenters</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; from numpy import array</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(PCG64(123))</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        &gt;&gt;&gt; clucenters(3, array([30,10]), array([-50,50]), rng=prng)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        array([[-33.58833231,  36.61463056],</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">               [-75.16761145,  40.53115432],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">               [-79.1684689 ,  59.3628352 ]])</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">      num_clusters: Number of clusters.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">      clu_sep: Average cluster separation ( $n \times 1$ vector).</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">      clu_offset: Cluster offsets ( $n \times 1$ vector).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        A $c \times n$ matrix containing the cluster centers.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="c1"># Obtain a num_clusters x num_dims matrix of uniformly distributed values</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="c1"># between -0.5 and 0.5 representing the relative cluster centers</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">ctr_rel</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">clu_sep</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.5</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="k">return</span> <span class="n">num_clusters</span> <span class="o">*</span> <span class="p">(</span><span class="n">ctr_rel</span> <span class="o">@</span> <span class="n">diag</span><span class="p">(</span><span class="n">clu_sep</span><span class="p">))</span> <span class="o">+</span> <span class="n">clu_offset</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clugen" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clugen</span>


<a href="#pyclugen.clugen" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clugen</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">direction</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">angle_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">cluster_sep</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">llength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">llength_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">lateral_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">cluster_offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">proj_dist_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">point_dist_fn</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="nb">str</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>            <span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="p">]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;n-1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">clusizes_fn</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArrayLike</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="p">)</span> <span class="o">=</span> <span class="n">clusizes</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">clucenters_fn</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArrayLike</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="p">)</span> <span class="o">=</span> <span class="n">clucenters</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="n">llengths_fn</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArrayLike</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="p">)</span> <span class="o">=</span> <span class="n">llengths</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">angle_deltas_fn</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArrayLike</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="p">)</span> <span class="o">=</span> <span class="n">angle_deltas</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="n">rng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Clusters</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Generate multidimensional clusters.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This is the main function of the <strong>pyclugen</strong> package, and possibly the
only function most users will need.</p>
</div>
<h4 id="pyclugen.clugen--examples">Examples:<a class="headerlink" href="#pyclugen.clugen--examples" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from pyclugen import clugen
&gt;&gt;&gt; from numpy import pi
&gt;&gt;&gt; out = clugen(2, 5, 10000, [1, 0.5], pi/16, [10, 40], 10, 1, 2, rng=321)
&gt;&gt;&gt; out.centers # What are the cluster centers?
array([[ 20.02876212,  36.59611434],
       [-15.60290734, -26.52169579],
       [ 23.09775166,  91.66309916],
       [ -5.76816015,  54.9775074 ],
       [ -4.64224681,  78.40990876]])
&gt;&gt;&gt; plt.scatter(out.points[:,0],
...             out.points[:,1],
...             c=out.clusters) # doctest: +SKIP
&gt;&gt;&gt; plt.show() # doctest: +SKIP
</code></pre></div>
<p><img alt="clugen" src="https://user-images.githubusercontent.com/3018963/151056890-c83c9509-b40d-4ab2-a842-f2a4706344c6.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the descriptions below, the terms "average" and "dispersion" refer to
measures of central tendency and statistical dispersion, respectively.
Their exact meaning depends on several optional arguments.</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_dims</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>num_clusters</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clusters to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>num_points</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of points to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>direction</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average direction of the cluster-supporting lines. Can be a
vector of length <code>num_dims</code> (same direction for all clusters) or a
matrix of size <code>num_clusters</code> x <code>num_dims</code> (one direction per cluster).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>angle_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Angle dispersion of cluster-supporting lines (radians).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cluster_sep</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average cluster separation in each dimension (vector of size
<code>num_dims</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>llength</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average length of cluster-supporting lines.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>llength_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length dispersion of cluster-supporting lines.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lateral_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cluster lateral dispersion, i.e., dispersion of points from their
projection on the cluster-supporting line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_empty</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Allow empty clusters? <code>False</code> by default.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cluster_offset</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Offset to add to all cluster centers (vector of size <code>num_dims</code>).
By default the offset will be equal to <code>numpy.zeros(num_dims)</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>proj_dist_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution of point projections along cluster-supporting lines,
with three possible values:</p>
<ul>
<li><code>"norm"</code> (default): Distribute point projections along lines using a normal
  distribution (μ=<em>line center</em>, σ=<code>llength/6</code>).</li>
<li><code>"unif"</code>: Distribute points uniformly along the line.</li>
<li>User-defined function, which accepts three parameters, line length (<code>float</code>),
  number of points (<code>int</code>), and an instance of
  <a href="https://numpy.org/doc/stable/reference/random/generator.html?highlight=generator#numpy.random.Generator"><code>Generator</code></a>,
  and returns an array containing the distance of each point projection to
  the center of the line. For example, the <code>"norm"</code> option roughly corresponds
  to <code>lambda l, n, rg: l * rg.random((n, 1)) / 6</code>.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;norm&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>point_dist_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>, <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Controls how the final points are created from their projections
on the cluster-supporting lines, with three possible values:</p>
<ul>
<li><code>"n-1"</code> (default): Final points are placed on a hyperplane orthogonal to
  the cluster-supporting line, centered at each point's projection, using the
  normal distribution (μ=0, σ=<code>lateral_disp</code>). This is done by the
  <a class="autorefs autorefs-internal" href="#pyclugen.clupoints_n_1"><code>clupoints_n_1()</code></a> function.</li>
<li><code>"n"</code>: Final points are placed around their projection on the
  cluster-supporting line using the normal distribution (μ=0,
  σ=<code>lateral_disp</code>). This is done by the
  <a class="autorefs autorefs-internal" href="#pyclugen.clupoints_n"><code>clupoints_n()</code></a> function.</li>
<li>User-defined function: The user can specify a custom point placement
  strategy by passing a function with the same signature as
  <a class="autorefs autorefs-internal" href="#pyclugen.clupoints_n_1"><code>clupoints_n_1()</code></a> and
  <a class="autorefs autorefs-internal" href="#pyclugen.clupoints_n"><code>clupoints_n()</code></a>.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;n-1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clusizes_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>] | <a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution of cluster sizes. By default, cluster sizes are
determined by the <a class="autorefs autorefs-internal" href="#pyclugen.clusizes"><code>clusizes()</code></a> function, which
uses the normal distribution (μ=<code>num_points</code>/<code>num_clusters</code>, σ=μ/3), and
assures that the final cluster sizes add up to <code>num_points</code>. This parameter
allows the user to specify a custom function for this purpose, which must
follow <a class="autorefs autorefs-internal" href="#pyclugen.clusizes"><code>clusizes()</code></a> signature. Note that custom
functions are not required to strictly obey the <code>num_points</code> parameter.
Alternatively, the user can specify an array of cluster sizes directly.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyclugen.module.clusizes" href="#pyclugen.clusizes">clusizes</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clucenters_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>, <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>] | <a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution of cluster centers. By default, cluster centers
are determined by the <a class="autorefs autorefs-internal" href="#pyclugen.clucenters"><code>clucenters()</code></a> function,
which uses the uniform distribution, and takes into account the <code>num_clusters</code>
and <code>cluster_sep</code> parameters for generating well-distributed cluster centers.
This parameter allows the user to specify a custom function for this purpose,
which must follow <a class="autorefs autorefs-internal" href="#pyclugen.clucenters"><code>clucenters()</code></a> signature.
Alternatively, the user can specify a matrix of size <code>num_clusters</code> x
<code>num_dims</code> with the exact cluster centers.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyclugen.module.clucenters" href="#pyclugen.clucenters">clucenters</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>llengths_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>] | <a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution of line lengths. By default, the lengths of
cluster-supporting lines are determined by the
<a class="autorefs autorefs-internal" href="#pyclugen.llengths"><code>llengths()</code></a> function, which uses the folded
normal distribution (μ=<code>llength</code>, σ=<code>llength_disp</code>). This parameter allows
the user to specify a custom function for this purpose, which must follow
<a class="autorefs autorefs-internal" href="#pyclugen.llengths"><code>llengths()</code></a> signature. Alternatively, the user
can specify an array of line lengths directly.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyclugen.module.llengths" href="#pyclugen.llengths">llengths</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>angle_deltas_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>] | <a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution of line angle differences with respect to
<code>direction</code>. By default, the angles between <code>direction</code> and the direction of
cluster-supporting lines are determined by the
<a class="autorefs autorefs-internal" href="#pyclugen.angle_deltas"><code>angle_deltas()</code></a> function, which uses the
wrapped normal distribution (μ=0, σ=<code>angle_disp</code>) with support in the interval
[-π/2, π/2]. This parameter allows the user to specify a custom function for
this purpose, which must follow <a class="autorefs autorefs-internal" href="#pyclugen.angle_deltas"><code>angle_deltas()</code></a>
signature. Alternatively, the user can specify an array of angle deltas
directly.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyclugen.module.angle_deltas" href="#pyclugen.angle_deltas">angle_deltas</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed for the random number generator or an instance of
<a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator"><code>Generator</code></a> for reproducible executions.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="pyclugen.main.Clusters" href="#pyclugen.Clusters">Clusters</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The generated clusters and associated information in the form of a
<a class="autorefs autorefs-internal" href="#pyclugen.Clusters"><code>Clusters</code></a> object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">def</span> <span class="nf">clugen</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">num_dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">direction</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">angle_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">cluster_sep</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">llength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">llength_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">lateral_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">cluster_offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">proj_dist_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">point_dist_fn</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;n-1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">clusizes_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">=</span> <span class="n">clusizes</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">clucenters_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">=</span> <span class="n">clucenters</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">llengths_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">=</span> <span class="n">llengths</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">angle_deltas_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">=</span> <span class="n">angle_deltas</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">rng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Clusters</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate multidimensional clusters.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    !!! tip</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        This is the main function of the **pyclugen** package, and possibly the</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        only function most users will need.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    ## Examples:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clugen</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt; from numpy import pi</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &gt;&gt;&gt; out = clugen(2, 5, 10000, [1, 0.5], pi/16, [10, 40], 10, 1, 2, rng=321)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; out.centers # What are the cluster centers?</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        array([[ 20.02876212,  36.59611434],</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">               [-15.60290734, -26.52169579],</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">               [ 23.09775166,  91.66309916],</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">               [ -5.76816015,  54.9775074 ],</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">               [ -4.64224681,  78.40990876]])</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; plt.scatter(out.points[:,0],</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ...             out.points[:,1],</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        ...             c=out.clusters) # doctest: +SKIP</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; plt.show() # doctest: +SKIP</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    ![clugen](https://user-images.githubusercontent.com/3018963/151056890-c83c9509-b40d-4ab2-a842-f2a4706344c6.png)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    !!! Note</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        In the descriptions below, the terms &quot;average&quot; and &quot;dispersion&quot; refer to</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        measures of central tendency and statistical dispersion, respectively.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        Their exact meaning depends on several optional arguments.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">      num_dims: Number of dimensions.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">      num_clusters: Number of clusters to generate.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">      num_points: Total number of points to generate.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">      direction: Average direction of the cluster-supporting lines. Can be a</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        vector of length `num_dims` (same direction for all clusters) or a</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        matrix of size `num_clusters` x `num_dims` (one direction per cluster).</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">      angle_disp: Angle dispersion of cluster-supporting lines (radians).</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">      cluster_sep: Average cluster separation in each dimension (vector of size</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        `num_dims`).</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">      llength: Average length of cluster-supporting lines.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">      llength_disp: Length dispersion of cluster-supporting lines.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">      lateral_disp: Cluster lateral dispersion, i.e., dispersion of points from their</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        projection on the cluster-supporting line.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">      allow_empty: Allow empty clusters? `False` by default.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">      cluster_offset: Offset to add to all cluster centers (vector of size `num_dims`).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        By default the offset will be equal to `numpy.zeros(num_dims)`.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">      proj_dist_fn: Distribution of point projections along cluster-supporting lines,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        with three possible values:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        - `&quot;norm&quot;` (default): Distribute point projections along lines using a normal</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">          distribution (μ=_line center_, σ=`llength/6`).</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        - `&quot;unif&quot;`: Distribute points uniformly along the line.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        - User-defined function, which accepts three parameters, line length (`float`),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">          number of points (`int`), and an instance of</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">          [`Generator`](https://numpy.org/doc/stable/reference/random/generator.html?highlight=generator#numpy.random.Generator),</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">          and returns an array containing the distance of each point projection to</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">          the center of the line. For example, the `&quot;norm&quot;` option roughly corresponds</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">          to `lambda l, n, rg: l * rg.random((n, 1)) / 6`.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">      point_dist_fn: Controls how the final points are created from their projections</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        on the cluster-supporting lines, with three possible values:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        - `&quot;n-1&quot;` (default): Final points are placed on a hyperplane orthogonal to</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">          the cluster-supporting line, centered at each point&#39;s projection, using the</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">          normal distribution (μ=0, σ=`lateral_disp`). This is done by the</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">          [`clupoints_n_1()`][pyclugen.module.clupoints_n_1] function.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        - `&quot;n&quot;`: Final points are placed around their projection on the</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">          cluster-supporting line using the normal distribution (μ=0,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">          σ=`lateral_disp`). This is done by the</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">          [`clupoints_n()`][pyclugen.module.clupoints_n] function.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        - User-defined function: The user can specify a custom point placement</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">          strategy by passing a function with the same signature as</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">          [`clupoints_n_1()`][pyclugen.module.clupoints_n_1] and</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">          [`clupoints_n()`][pyclugen.module.clupoints_n].</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">      clusizes_fn: Distribution of cluster sizes. By default, cluster sizes are</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        determined by the [`clusizes()`][pyclugen.module.clusizes] function, which</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        uses the normal distribution (μ=`num_points`/`num_clusters`, σ=μ/3), and</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        assures that the final cluster sizes add up to `num_points`. This parameter</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        allows the user to specify a custom function for this purpose, which must</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        follow [`clusizes()`][pyclugen.module.clusizes] signature. Note that custom</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        functions are not required to strictly obey the `num_points` parameter.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        Alternatively, the user can specify an array of cluster sizes directly.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">      clucenters_fn: Distribution of cluster centers. By default, cluster centers</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        are determined by the [`clucenters()`][pyclugen.module.clucenters] function,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        which uses the uniform distribution, and takes into account the `num_clusters`</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        and `cluster_sep` parameters for generating well-distributed cluster centers.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        This parameter allows the user to specify a custom function for this purpose,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        which must follow [`clucenters()`][pyclugen.module.clucenters] signature.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Alternatively, the user can specify a matrix of size `num_clusters` x</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        `num_dims` with the exact cluster centers.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">      llengths_fn: Distribution of line lengths. By default, the lengths of</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        cluster-supporting lines are determined by the</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        [`llengths()`][pyclugen.module.llengths] function, which uses the folded</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        normal distribution (μ=`llength`, σ=`llength_disp`). This parameter allows</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        the user to specify a custom function for this purpose, which must follow</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        [`llengths()`][pyclugen.module.llengths] signature. Alternatively, the user</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        can specify an array of line lengths directly.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">      angle_deltas_fn: Distribution of line angle differences with respect to</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        `direction`. By default, the angles between `direction` and the direction of</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        cluster-supporting lines are determined by the</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        [`angle_deltas()`][pyclugen.module.angle_deltas] function, which uses the</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        wrapped normal distribution (μ=0, σ=`angle_disp`) with support in the interval</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        [-π/2, π/2]. This parameter allows the user to specify a custom function for</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        this purpose, which must follow [`angle_deltas()`][pyclugen.module.angle_deltas]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        signature. Alternatively, the user can specify an array of angle deltas</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        directly.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">      rng: The seed for the random number generator or an instance of</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        [`Generator`][numpy.random.Generator] for reproducible executions.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">      The generated clusters and associated information in the form of a</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        [`Clusters`][pyclugen.main.Clusters] object.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="c1"># ############### #</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="c1"># Validate inputs #</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># ############### #</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="c1"># Check that number of dimensions is &gt; 0</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">if</span> <span class="n">num_dims</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of dimensions, `num_dims`, must be &gt; 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="c1"># Check that number of clusters is &gt; 0</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">if</span> <span class="n">num_clusters</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of clusters, `num_clust`, must be &gt; 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="c1"># Convert given direction into a NumPy array</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">arrdir</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="c1"># Get number of dimensions in `direction` array</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">dir_ndims</span> <span class="o">=</span> <span class="n">arrdir</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="c1"># Is direction a vector or a matrix?</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">if</span> <span class="n">dir_ndims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># It&#39;s a vector, let&#39;s convert it into a row matrix, since this will be</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="c1"># useful down the road</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">arrdir</span> <span class="o">=</span> <span class="n">arrdir</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">elif</span> <span class="n">dir_ndims</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="c1"># If a matrix was given (i.e. a main direction is given for each cluster),</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="c1"># check if the number of directions is the same as the number of clusters</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">dir_size_1</span> <span class="o">=</span> <span class="n">arrdir</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="n">dir_size_1</span> <span class="o">!=</span> <span class="n">num_clusters</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="s2">&quot;Number of rows in `direction` must be the same as the &quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;number of clusters (</span><span class="si">{</span><span class="n">dir_size_1</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">num_clusters</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="c1"># The `directions` array must be a vector or a matrix, so if we get here</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># it means we have invalid arguments</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="s2">&quot;`direction` must be a vector (1D array) or a matrix (2D array), &quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but is </span><span class="si">{</span><span class="n">dir_ndims</span><span class="si">}</span><span class="s2">D&quot;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="c1"># Check that direction has num_dims dimensions</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">dir_size_2</span> <span class="o">=</span> <span class="n">arrdir</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">if</span> <span class="n">dir_size_2</span> <span class="o">!=</span> <span class="n">num_dims</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="s2">&quot;Length of directions in `direction` must be equal to &quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;`num_dims` (</span><span class="si">{</span><span class="n">dir_size_2</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">num_dims</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="c1"># Check that directions have magnitude &gt; 0</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">dir_magnitudes</span> <span class="o">=</span> <span class="n">apply_along_axis</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arrdir</span><span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">dir_magnitudes</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Directions in `direction` must have magnitude &gt; 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="c1"># If allow_empty is false, make sure there are enough points to distribute</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="c1"># by the clusters</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">allow_empty</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num_points</span> <span class="o">&lt;</span> <span class="n">num_clusters</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="sa">f</span><span class="s2">&quot;A total of </span><span class="si">{</span><span class="n">num_points</span><span class="si">}</span><span class="s2"> points is not enough for &quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num_clusters</span><span class="si">}</span><span class="s2"> non-empty clusters&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="c1"># Check that cluster_sep has num_dims dimensions</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">cluster_sep</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">cluster_sep</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">cluster_sep</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">num_dims</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="s2">&quot;Length of `cluster_sep` must be equal to `num_dims` &quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">cluster_sep</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">num_dims</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="c1"># If given, cluster_offset must have the correct number of dimensions,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="c1"># if not given then it will be a num_dims x 1 vector of zeros</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">if</span> <span class="n">cluster_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">cluster_offset</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">cluster_offset</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">cluster_offset</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">if</span> <span class="n">cluster_offset</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">num_dims</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                <span class="s2">&quot;Length of `cluster_offset` must be equal to `num_dims` &quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">cluster_offset</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">num_dims</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="c1"># If the user specified rng as an int, create a proper rng object</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">rng_sel</span><span class="p">:</span> <span class="n">Generator</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">Generator</span><span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">rng_sel</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Generator</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">rng_sel</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">rng</span><span class="p">)))</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="sa">f</span><span class="s2">&quot;`rng` must be an instance of int or Generator, but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="c1"># Check that proj_dist_fn specifies a valid way for projecting points along</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># cluster-supporting lines i.e., either &quot;norm&quot; (default), &quot;unif&quot; or a</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="c1"># user-defined function</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">pointproj_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">proj_dist_fn</span><span class="p">):</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="c1"># Use user-defined distribution; assume function accepts length of line</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="c1"># and number of points, and returns a number of points x 1 vector</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">pointproj_fn</span> <span class="o">=</span> <span class="n">proj_dist_fn</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">elif</span> <span class="n">proj_dist_fn</span> <span class="o">==</span> <span class="s2">&quot;unif&quot;</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="c1"># Point projections will be uniformly placed along cluster-supporting lines</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">def</span> <span class="nf">pointproj_fn</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rg</span><span class="p">):</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">return</span> <span class="n">length</span> <span class="o">*</span> <span class="n">rg</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">elif</span> <span class="n">proj_dist_fn</span> <span class="o">==</span> <span class="s2">&quot;norm&quot;</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="c1"># Use normal distribution for placing point projections along cluster-supporting</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="c1"># lines, mean equal to line center, standard deviation equal to 1/6 of line</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="c1"># length such that the line length contains ≈99.73% of the points</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">def</span> <span class="nf">pointproj_fn</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rg</span><span class="p">):</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">length</span> <span class="o">*</span> <span class="n">rg</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="s2">&quot;`proj_dist_fn` has to be either &#39;norm&#39;, &#39;unif&#39; or user-defined function&quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="c1"># Check that point_dist_fn specifies a valid way for generating points given</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="c1"># their projections along cluster-supporting lines, i.e., either &quot;n-1&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="c1"># (default), &quot;n&quot; or a user-defined function</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">pt_from_proj_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="p">]</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">if</span> <span class="n">num_dims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="c1"># If 1D was specified, point projections are the points themselves</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="k">def</span> <span class="nf">pt_from_proj_fn</span><span class="p">(</span><span class="n">projs</span><span class="p">,</span> <span class="n">lat_disp</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">clu_dir</span><span class="p">,</span> <span class="n">clu_ctr</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng_sel</span><span class="p">):</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">return</span> <span class="n">projs</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">point_dist_fn</span><span class="p">):</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="c1"># Use user-defined distribution; assume function accepts point projections</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="c1"># on the line, lateral disp., cluster direction and cluster center, and</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="c1"># returns a num_points x num_dims matrix containing the final points</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="c1"># for the current cluster</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">pt_from_proj_fn</span> <span class="o">=</span> <span class="n">point_dist_fn</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="k">elif</span> <span class="n">point_dist_fn</span> <span class="o">==</span> <span class="s2">&quot;n-1&quot;</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="c1"># Points will be placed on a hyperplane orthogonal to the cluster-supporting</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="c1"># line using a normal distribution centered at their intersection</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">pt_from_proj_fn</span> <span class="o">=</span> <span class="n">clupoints_n_1</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="k">elif</span> <span class="n">point_dist_fn</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="c1"># Points will be placed using a multivariate normal distribution</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="c1"># centered at the point projection</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">pt_from_proj_fn</span> <span class="o">=</span> <span class="n">clupoints_n</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="s2">&quot;point_dist_fn has to be either &#39;n-1&#39;, &#39;n&#39; or a user-defined function&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="c1"># ############################ #</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="c1"># Determine cluster properties #</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="c1"># ############################ #</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="c1"># Normalize main direction(s)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">arrdir</span> <span class="o">=</span> <span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arrdir</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># If only one main direction was given, expand it for all clusters</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">if</span> <span class="n">dir_ndims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">arrdir</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">arrdir</span><span class="p">,</span> <span class="n">num_clusters</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="c1"># Determine cluster sizes</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">clusizes_fn</span><span class="p">):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">cluster_sizes</span> <span class="o">=</span> <span class="n">clusizes_fn</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">allow_empty</span><span class="p">,</span> <span class="n">rng_sel</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">clusizes_fn</span><span class="p">))</span> <span class="o">==</span> <span class="n">num_clusters</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">cluster_sizes</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">clusizes_fn</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="s2">&quot;clusizes_fn has to be either a function or a `num_clusters`-sized array&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="c1"># Custom clusizes_fn&#39;s are not required to obey num_points, so we update</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="c1"># it here just in case it&#39;s different from what the user specified</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="n">num_points</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cluster_sizes</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="c1"># Determine cluster centers</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">clucenters_fn</span><span class="p">):</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">clucenters_fn</span><span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="n">num_clusters</span><span class="p">,</span> <span class="n">cluster_sep</span><span class="p">,</span> <span class="n">cluster_offset</span><span class="p">,</span> <span class="n">rng_sel</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">elif</span> <span class="n">asarray</span><span class="p">(</span><span class="n">clucenters_fn</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">num_dims</span><span class="p">):</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">clucenters_fn</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="s2">&quot;clucenters_fn has to be either a function or a matrix of size &quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="o">+</span> <span class="s2">&quot;`num_clusters` x `num_dims`&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="c1"># Determine length of lines supporting clusters</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">llengths_fn</span><span class="p">):</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">cluster_lengths</span> <span class="o">=</span> <span class="n">llengths_fn</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">llength</span><span class="p">,</span> <span class="n">llength_disp</span><span class="p">,</span> <span class="n">rng_sel</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">llengths_fn</span><span class="p">))</span> <span class="o">==</span> <span class="n">num_clusters</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">cluster_lengths</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">llengths_fn</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="s2">&quot;llengths_fn has to be either a function or a `num_clusters`-sized array&quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="c1"># Obtain angles between main direction and cluster-supporting lines</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">angle_deltas_fn</span><span class="p">):</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">cluster_angles</span> <span class="o">=</span> <span class="n">angle_deltas_fn</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">angle_disp</span><span class="p">,</span> <span class="n">rng_sel</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle_deltas_fn</span><span class="p">))</span> <span class="o">==</span> <span class="n">num_clusters</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">cluster_angles</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">angle_deltas_fn</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="s2">&quot;angle_deltas_fn has to be either a function or a &quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="o">+</span> <span class="s2">&quot;`num_clusters`-sized array&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="c1"># Determine normalized cluster directions by applying the obtained angles</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">cluster_directions</span> <span class="o">=</span> <span class="n">apply_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">rand_vector_at_angle</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">rng_sel</span><span class="p">),</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="n">arrdir</span><span class="p">,</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="nb">iter</span><span class="p">(</span><span class="n">cluster_angles</span><span class="p">),</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="c1"># ################################# #</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="c1"># Determine points for each cluster #</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># ################################# #</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="c1"># Aux. vector with cumulative sum of number of points in each cluster</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">cumsum_points</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">cluster_sizes</span><span class="p">)))</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="c1"># Pre-allocate data structures for holding cluster info and points</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">point_clusters</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">num_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="p">)</span>  <span class="c1"># Cluster indices of each point</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">point_projections</span> <span class="o">=</span> <span class="n">empty</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="n">num_dims</span><span class="p">))</span>  <span class="c1"># Point projections on</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="c1">#                                                  # cluster-supporting lines</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">empty</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="n">num_dims</span><span class="p">))</span>  <span class="c1"># Final points to be generated</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="c1"># Loop through clusters and create points for each one</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="c1"># Start and end indexes for points in current cluster</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">idx_start</span> <span class="o">=</span> <span class="n">cumsum_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">idx_end</span> <span class="o">=</span> <span class="n">cumsum_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="c1"># Update cluster indices of each point</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">point_clusters</span><span class="p">[</span><span class="n">idx_start</span><span class="p">:</span><span class="n">idx_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="c1"># Determine distance of point projections from the center of the line</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">ptproj_dist_fn_center</span> <span class="o">=</span> <span class="n">pointproj_fn</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">cluster_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cluster_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rng_sel</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="c1"># Determine coordinates of point projections on the line using the</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="c1"># parametric line equation (this works since cluster direction is normalized)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">point_projections</span><span class="p">[</span><span class="n">idx_start</span><span class="p">:</span><span class="n">idx_end</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">points_on_line</span><span class="p">(</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="n">cluster_centers</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">cluster_directions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">ptproj_dist_fn_center</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="c1"># Determine points from their projections on the line</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">points</span><span class="p">[</span><span class="n">idx_start</span><span class="p">:</span><span class="n">idx_end</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pt_from_proj_fn</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">point_projections</span><span class="p">[</span><span class="n">idx_start</span><span class="p">:</span><span class="n">idx_end</span><span class="p">,</span> <span class="p">:],</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">lateral_disp</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">cluster_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">cluster_directions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="n">cluster_centers</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">rng_sel</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">return</span> <span class="n">Clusters</span><span class="p">(</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">points</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">point_clusters</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">point_projections</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="n">cluster_sizes</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="n">cluster_centers</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">cluster_directions</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">cluster_angles</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">cluster_lengths</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clumerge" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clumerge</span>


<a href="#pyclugen.clumerge" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clumerge</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">NamedTuple</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">fields</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="s2">&quot;clusters&quot;</span><span class="p">),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">clusters_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;clusters&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Merges the fields (specified in <code>fields</code>) of two or more <code>data</code> sets.</p>
<p>Merges the fields (specified in <code>fields</code>) of two or more <code>data</code> sets (named
tuples or dictionaries). The fields to be merged need to have the same
number of columns. The corresponding merged field will contain the rows of
the fields to be merged, and will have a common supertype.</p>
<p>The <code>clusters_field</code> parameter specifies a field containing integers that
identify the cluster to which the respective points belongs to. If
<code>clusters_field</code> is specified (by default it's specified as <code>"clusters"</code>),
cluster assignments in individual datasets will be updated in the merged
dataset so that clusters are considered separate. This parameter can be set
to <code>None</code>, in which case no field will be considered as a special cluster
assignments field.</p>
<p>This function can be used to merge data sets generated with the
<a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> function, by default merging the
<code>points</code> and <code>clusters</code> fields in those data sets. It also works with
arbitrary data by specifying alternative fields in the <code>fields</code> parameter.
It can be used, for example, to merge third-party data with
<a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a>-generated data.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clugen</span><span class="p">,</span> <span class="n">clumerge</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">clugen</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="mi">14</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">clugen</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">);</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data3</span> <span class="o">=</span> <span class="n">clugen</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">);</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data_merged</span> <span class="o">=</span> <span class="n">clumerge</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>*data</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.NamedTuple" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple">NamedTuple</a> | <a class="autorefs autorefs-external" title="collections.abc.Mapping" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="numpy.typing.ArrayLike" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.ArrayLike">ArrayLike</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One or more cluster data sets whose <code>fields</code> are to be merged.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fields</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fields to be merged, which must exist in the data set given in
<code>*data</code>.</p>
              </div>
            </td>
            <td>
                  <code>(&#39;points&#39;, &#39;clusters&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clusters_field</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field containing the integer cluster labels. If specified,
cluster assignments in individual datasets will be updated in the merged
dataset so that clusters are considered separate.</p>
              </div>
            </td>
            <td>
                  <code>&#39;clusters&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary, where keys correspond to field names, and values to the
merged numerical arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="k">def</span> <span class="nf">clumerge</span><span class="p">(</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">NamedTuple</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">],</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="n">fields</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="s2">&quot;clusters&quot;</span><span class="p">),</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="n">clusters_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;clusters&quot;</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Merges the fields (specified in `fields`) of two or more `data` sets.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    Merges the fields (specified in `fields`) of two or more `data` sets (named</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    tuples or dictionaries). The fields to be merged need to have the same</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    number of columns. The corresponding merged field will contain the rows of</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">    the fields to be merged, and will have a common supertype.</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    The `clusters_field` parameter specifies a field containing integers that</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    identify the cluster to which the respective points belongs to. If</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    `clusters_field` is specified (by default it&#39;s specified as `&quot;clusters&quot;`),</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    cluster assignments in individual datasets will be updated in the merged</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    dataset so that clusters are considered separate. This parameter can be set</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    to `None`, in which case no field will be considered as a special cluster</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    assignments field.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    This function can be used to merge data sets generated with the</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    [`clugen()`][pyclugen.main.clugen] function, by default merging the</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    `points` and `clusters` fields in those data sets. It also works with</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    arbitrary data by specifying alternative fields in the `fields` parameter.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    It can be used, for example, to merge third-party data with</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">    [`clugen()`][pyclugen.main.clugen]-generated data.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clugen, clumerge</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        &gt;&gt;&gt; data1 = clugen(2, 5, 1000, [1, 1], 0.01, [20, 20], 14, 1.2, 1.5);</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        &gt;&gt;&gt; data2 = clugen(2, 3, 450, [0.8, -0.3], 0, [25, 21], 6, 0.4, 3.5);</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        &gt;&gt;&gt; data3 = clugen(2, 2, 600, [0, -0.7], 0.2, [15, 10], 1, 0.1, 5.2);</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        &gt;&gt;&gt; data_merged = clumerge(data1, data2, data3)</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">      *data: One or more cluster data sets whose `fields` are to be merged.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">      fields: Fields to be merged, which must exist in the data set given in</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        `*data`.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">      clusters_field: Field containing the integer cluster labels. If specified,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        cluster assignments in individual datasets will be updated in the merged</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        dataset so that clusters are considered separate.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">      A dictionary, where keys correspond to field names, and values to the</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        merged numerical arrays.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="c1"># Number of elements in each array the merged dataset</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">numel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="c1"># Number of columns of values in each field</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="n">fields_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="c1"># Merged dataset to output, initially empty</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="c1"># Create a fields set</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="n">fields_set</span><span class="p">:</span> <span class="n">MutableSet</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="c1"># If a clusters field is given, add it</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">if</span> <span class="n">clusters_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">fields_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">clusters_field</span><span class="p">))</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="c1"># Data in dictionary format with NDArray views on data</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="n">ddata</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="c1"># If dt is a named tuple, convert it into a dictionary</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">ddt</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">]</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="n">ddt</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="n">ntdt</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="n">ddt</span> <span class="o">=</span> <span class="n">ntdt</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="c1"># Convert dictionary values to NDArrays</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">ddtnp</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ddt</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="c1"># Add converted dictionary to our sequence of dictionaries</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">ddata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ddtnp</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="c1"># Cycle through data items</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">ddata</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="c1"># Number of elements in the current item</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">numel_i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="c1"># Cycle through fields for the current item</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_set</span><span class="p">:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dt</span><span class="p">:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data item does not contain required field `</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="n">clusters_field</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">can_cast</span><span class="p">(</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="n">dt</span><span class="p">[</span><span class="n">clusters_field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">int64</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>            <span class="p">):</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">clusters_field</span><span class="si">}</span><span class="s2">` must contain integer types&quot;</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="c1"># Get the field value</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="n">value</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="c1"># Number of elements in field value</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">numel_tmp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>            <span class="c1"># Check the number of elements in the field value</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="k">if</span> <span class="n">numel_i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="c1"># First field: get number of elements in value (must be the same</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="c1"># for the remaining field values)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="n">numel_i</span> <span class="o">=</span> <span class="n">numel_tmp</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="k">elif</span> <span class="n">numel_tmp</span> <span class="o">!=</span> <span class="n">numel_i</span><span class="p">:</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                <span class="c1"># Fields values after the first must have the same number of</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                <span class="c1"># elements</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                    <span class="s2">&quot;Data item contains fields with different sizes &quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>                    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">numel_tmp</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">numel_i</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="c1"># Get/check info about the field value type</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields_info</span><span class="p">:</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="c1"># If it&#39;s the first time this field appears, just get the info</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">_FieldInfo</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">_getcols</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                <span class="c1"># If this field already appeared in previous data items, get the</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                <span class="c1"># info and check/determine its compatibility with respect to</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="c1"># previous data items</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                <span class="k">if</span> <span class="n">_getcols</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">ncol</span><span class="p">:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                    <span class="c1"># Number of columns must be the same</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimension mismatch in field `</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                <span class="c1"># Get the common supertype</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">promote_types</span><span class="p">(</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>                    <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                <span class="p">)</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="c1"># Update total number of elements</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="n">numel</span> <span class="o">+=</span> <span class="n">numel_i</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="c1"># Initialize output dictionary fields with room for all items</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_info</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="k">if</span> <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">ncol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">output</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">empty</span><span class="p">((</span><span class="n">numel</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">output</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>                <span class="p">(</span><span class="n">numel</span><span class="p">,</span> <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">ncol</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="p">)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="c1"># Copy items from input data to output dictionary, field-wise</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="n">copied</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="n">last_cluster</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="c1"># Create merged output</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">ddata</span><span class="p">:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="c1"># How many elements to copy for the current data item?</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">tocopy</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dt</span><span class="p">[</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="c1"># Cycle through each field and its information</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_info</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="c1"># Copy elements</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="n">clusters_field</span><span class="p">:</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                <span class="c1"># If this is a clusters field, update the cluster IDs</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                <span class="n">old_clusters</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">dt</span><span class="p">[</span><span class="n">clusters_field</span><span class="p">])</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="n">new_clusters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                    <span class="nb">range</span><span class="p">(</span><span class="n">last_cluster</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last_cluster</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_clusters</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="n">old2new</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">old_clusters</span><span class="p">,</span> <span class="n">new_clusters</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">old2new</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="n">last_cluster</span> <span class="o">=</span> <span class="n">new_clusters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="n">output</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">copied</span> <span class="p">:</span> <span class="p">(</span><span class="n">copied</span> <span class="o">+</span> <span class="n">tocopy</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                    <span class="n">mapping</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dt</span><span class="p">[</span><span class="n">clusters_field</span><span class="p">]</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                <span class="p">]</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="c1"># Otherwise just copy the elements</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                <span class="n">ncol</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">fields_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">ncol</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                <span class="n">output</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">copied</span> <span class="o">*</span> <span class="n">ncol</span> <span class="p">:</span> <span class="p">(</span><span class="n">copied</span> <span class="o">+</span> <span class="n">tocopy</span><span class="p">)</span> <span class="o">*</span> <span class="n">ncol</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="c1"># Update how many were copied so far</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">copied</span> <span class="o">+=</span> <span class="n">tocopy</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="c1"># Return result</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clupoints_n" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clupoints_n</span>


<a href="#pyclugen.clupoints_n" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clupoints_n</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">line_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">clu_ctr</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Generate points from their <span class="arithmatex">\(n\)</span>-D projections on a cluster-supporting line.</p>
<p>Each point is placed around its projection using the normal distribution
( <span class="arithmatex">\(\mu=0\)</span>, <span class="arithmatex">\(σ=\)</span><code>lat_disp</code>).</p>
<p>This function's main intended use is by the <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a>
function, generating the final points when the <code>point_dist_fn</code> parameter is
set to <code>"n"</code>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clupoints_n</span><span class="p">,</span> <span class="n">points_on_line</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">linspace</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">projs</span> <span class="o">=</span> <span class="n">points_on_line</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>     <span class="c1"># Get 5 point projections</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>                       <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span>     <span class="c1"># on a 2D line</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>                       <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">projs</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">array([[1., 5.],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">       [3., 5.],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">       [5., 5.],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">       [7., 5.],</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">       [9., 5.]])</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clupoints_n</span><span class="p">(</span><span class="n">projs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">array([[0.50543932, 4.81610667],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">       [3.64396263, 5.09698721],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">       [5.46011545, 5.2885519 ],</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">       [6.68176818, 5.27097611],</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">       [8.84170227, 4.83880544]])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>projs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point projections on the cluster-supporting line ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lat_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation for the normal distribution, i.e., cluster
lateral dispersion.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>line_len</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of cluster-supporting line (ignored).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_dir</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction of the cluster-supporting line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_ctr</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center position of the cluster-supporting line (ignored).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated points ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="k">def</span> <span class="nf">clupoints_n</span><span class="p">(</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">line_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">clu_ctr</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Generate points from their $n$-D projections on a cluster-supporting line.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    Each point is placed around its projection using the normal distribution</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    ( $\mu=0$, $σ=$`lat_disp`).</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    This function&#39;s main intended use is by the [`clugen()`][pyclugen.main.clugen]</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    function, generating the final points when the `point_dist_fn` parameter is</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    set to `&quot;n&quot;`.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clupoints_n, points_on_line</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        &gt;&gt;&gt; from numpy import array, linspace</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(PCG64(123))</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &gt;&gt;&gt; projs = points_on_line(array([5,5]),     # Get 5 point projections</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        ...                        array([1,0]),     # on a 2D line</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        ...                        linspace(-4,4,5))</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        &gt;&gt;&gt; projs</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        array([[1., 5.],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">               [3., 5.],</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">               [5., 5.],</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">               [7., 5.],</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">               [9., 5.]])</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &gt;&gt;&gt; clupoints_n(projs, 0.5, 1.0, array([1,0]), array([0,0]), rng=prng)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        array([[0.50543932, 4.81610667],</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">               [3.64396263, 5.09698721],</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">               [5.46011545, 5.2885519 ],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">               [6.68176818, 5.27097611],</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">               [8.84170227, 4.83880544]])</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">      projs: Point projections on the cluster-supporting line ( $p \times n$ matrix).</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">      lat_disp: Standard deviation for the normal distribution, i.e., cluster</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        lateral dispersion.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">      line_len: Length of cluster-supporting line (ignored).</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">      clu_dir: Direction of the cluster-supporting line.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">      clu_ctr: Center position of the cluster-supporting line (ignored).</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      Generated points ( $p \times n$ matrix).</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="c1"># Number of dimensions</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">num_dims</span> <span class="o">=</span> <span class="n">clu_dir</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Number of points in this cluster</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">clu_num_points</span> <span class="o">=</span> <span class="n">projs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># Get random displacement vectors for each point projection</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">displ</span> <span class="o">=</span> <span class="n">lat_disp</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">,</span> <span class="n">num_dims</span><span class="p">))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="c1"># Add displacement vectors to each point projection</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">projs</span> <span class="o">+</span> <span class="n">displ</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">return</span> <span class="n">points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clupoints_n_1" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clupoints_n_1</span>


<a href="#pyclugen.clupoints_n_1" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clupoints_n_1</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">line_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">clu_ctr</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Generate points from their <span class="arithmatex">\(n\)</span>-D projections on a cluster-supporting line.</p>
<p>Each point is placed on a hyperplane orthogonal to that line and centered at
the point's projection, using the normal distribution ( <span class="arithmatex">\(\mu=0\)</span>,
<span class="arithmatex">\(σ=\)</span><code>lat_disp</code>).</p>
<p>This function's main intended use is by the <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a>
function, generating the final points when the <code>point_dist_fn</code> parameter is
set to <code>"n-1"</code>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clupoints_n_1</span><span class="p">,</span> <span class="n">points_on_line</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">linspace</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">projs</span> <span class="o">=</span> <span class="n">points_on_line</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>     <span class="c1"># Get 5 point projections</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>                       <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span>     <span class="c1"># on a 2D line</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>                       <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">projs</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">array([[1., 5.],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">       [3., 5.],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">       [5., 5.],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">       [7., 5.],</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">       [9., 5.]])</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clupoints_n_1</span><span class="p">(</span><span class="n">projs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">array([[1.        , 5.49456068],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">       [3.        , 5.18389333],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">       [5.        , 5.64396263],</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">       [7.        , 5.09698721],</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">       [9.        , 5.46011545]])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>projs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point projections on the cluster-supporting line ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lat_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation for the normal distribution, i.e., cluster
lateral dispersion.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>line_len</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of cluster-supporting line (ignored).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_dir</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction of the cluster-supporting line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_ctr</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center position of the cluster-supporting line (ignored).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated points ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="k">def</span> <span class="nf">clupoints_n_1</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">line_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">clu_ctr</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Generate points from their $n$-D projections on a cluster-supporting line.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Each point is placed on a hyperplane orthogonal to that line and centered at</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    the point&#39;s projection, using the normal distribution ( $\mu=0$,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    $σ=$`lat_disp`).</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    This function&#39;s main intended use is by the [`clugen()`][pyclugen.main.clugen]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    function, generating the final points when the `point_dist_fn` parameter is</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    set to `&quot;n-1&quot;`.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clupoints_n_1, points_on_line</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        &gt;&gt;&gt; from numpy import array, linspace</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(PCG64(123))</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; projs = points_on_line(array([5,5]),     # Get 5 point projections</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        ...                        array([1,0]),     # on a 2D line</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        ...                        linspace(-4,4,5))</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        &gt;&gt;&gt; projs</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        array([[1., 5.],</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">               [3., 5.],</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">               [5., 5.],</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">               [7., 5.],</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">               [9., 5.]])</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        &gt;&gt;&gt; clupoints_n_1(projs, 0.5, 1.0, array([1,0]), array([0,0]), rng=prng)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        array([[1.        , 5.49456068],</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">               [3.        , 5.18389333],</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">               [5.        , 5.64396263],</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">               [7.        , 5.09698721],</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">               [9.        , 5.46011545]])</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">      projs: Point projections on the cluster-supporting line ( $p \times n$ matrix).</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">      lat_disp: Standard deviation for the normal distribution, i.e., cluster</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        lateral dispersion.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">      line_len: Length of cluster-supporting line (ignored).</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">      clu_dir: Direction of the cluster-supporting line.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">      clu_ctr: Center position of the cluster-supporting line (ignored).</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">      Generated points ( $p \times n$ matrix).</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="c1"># No blank line allowed here</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="c1"># Define function to get distances from points to their projections on the</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="c1"># line (i.e., using the normal distribution)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">def</span> <span class="nf">dist_fn</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">,</span> <span class="n">ldisp</span><span class="p">,</span> <span class="n">rg</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="k">return</span> <span class="n">ldisp</span> <span class="o">*</span> <span class="n">rg</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1"># Use clupoints_n_1_template() to do the heavy lifting</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="k">return</span> <span class="n">clupoints_n_1_template</span><span class="p">(</span><span class="n">projs</span><span class="p">,</span> <span class="n">lat_disp</span><span class="p">,</span> <span class="n">clu_dir</span><span class="p">,</span> <span class="n">dist_fn</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clupoints_n_1_template" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clupoints_n_1_template</span>


<a href="#pyclugen.clupoints_n_1_template" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clupoints_n_1_template</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Create <span class="arithmatex">\(p\)</span> points from their <span class="arithmatex">\(n\)</span>-D projections on a cluster-supporting line.</p>
<p>Each point is placed on a hyperplane orthogonal to that line and centered at
the point's projection. The function specified in <code>dist_fn</code> is used to perform
the actual placement.</p>
<p>This function is used internally by
<a class="autorefs autorefs-internal" href="#pyclugen.clupoints_n_1"><code>clupoints_n_1()</code></a> and may be useful for
constructing user-defined final point placement strategies for the <code>point_dist_fn</code>
parameter of the main <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> function.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">zeros</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clupoints_n_1_template</span><span class="p">,</span> <span class="n">points_on_line</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ctr</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pdist</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">proj</span> <span class="o">=</span> <span class="n">points_on_line</span><span class="p">(</span><span class="n">ctr</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">pdist</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clupoints_n_1_template</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">array([[-0.5       ,  0.68235186],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">       [-0.2       , -0.05382102],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">       [ 0.1       ,  0.22035987],</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">       [ 0.3       , -0.18437181]])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>projs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point projections on the cluster-supporting line ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lat_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dispersion of points from their projection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clu_dir</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction of the cluster-supporting line (unit vector).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dist_fn</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a>], <a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to place points on a second line, orthogonal to the first.
The functions accepts as parameters the number of points in the current
cluster, the <code>lateral_disp</code> parameter (the same passed to the
<a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> function), and a random number generator,
returning a vector containing the distance of each point to its projection
on the cluster-supporting line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional pseudo-random number generator for reproducible executions.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated points ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">def</span> <span class="nf">clupoints_n_1_template</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">projs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">lat_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">clu_dir</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Generator</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">],</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Create $p$ points from their $n$-D projections on a cluster-supporting line.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Each point is placed on a hyperplane orthogonal to that line and centered at</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    the point&#39;s projection. The function specified in `dist_fn` is used to perform</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    the actual placement.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    This function is used internally by</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    [`clupoints_n_1()`][pyclugen.module.clupoints_n_1] and may be useful for</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    constructing user-defined final point placement strategies for the `point_dist_fn`</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    parameter of the main [`clugen()`][pyclugen.main.clugen] function.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        &gt;&gt;&gt; from numpy import array, zeros</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clupoints_n_1_template, points_on_line</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        &gt;&gt;&gt; ctr = zeros(2)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; dir = array([1, 0])</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; pdist = array([-0.5, -0.2, 0.1, 0.3])</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; rng = Generator(PCG64(123))</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        &gt;&gt;&gt; proj = points_on_line(ctr, dir, pdist)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; clupoints_n_1_template(proj, 0, dir, lambda p, l, r: r.random(p), rng=rng)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        array([[-0.5       ,  0.68235186],</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">               [-0.2       , -0.05382102],</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">               [ 0.1       ,  0.22035987],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">               [ 0.3       , -0.18437181]])</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">      projs: Point projections on the cluster-supporting line ( $p \times n$ matrix).</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">      lat_disp: Dispersion of points from their projection.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">      clu_dir: Direction of the cluster-supporting line (unit vector).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">      dist_fn: Function to place points on a second line, orthogonal to the first.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        The functions accepts as parameters the number of points in the current</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        cluster, the `lateral_disp` parameter (the same passed to the</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        [`clugen()`][pyclugen.main.clugen] function), and a random number generator,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        returning a vector containing the distance of each point to its projection</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        on the cluster-supporting line.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">      rng: An optional pseudo-random number generator for reproducible executions.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">      Generated points ( $p \times n$ matrix).</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="c1"># Number of dimensions</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">num_dims</span> <span class="o">=</span> <span class="n">clu_dir</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="c1"># Number of points in this cluster</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">clu_num_points</span> <span class="o">=</span> <span class="n">projs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="c1"># Get distances from points to their projections on the line</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">points_dist</span> <span class="o">=</span> <span class="n">dist_fn</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">,</span> <span class="n">lat_disp</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="c1"># Get normalized vectors, orthogonal to the current line, for each point</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">orth_vecs</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">clu_num_points</span><span class="p">,</span> <span class="n">num_dims</span><span class="p">))</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">orth_vecs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">rand_ortho_vector</span><span class="p">(</span><span class="n">clu_dir</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1"># Set vector magnitudes</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">orth_vecs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">points_dist</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">orth_vecs</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="c1"># Add perpendicular vectors to point projections on the line,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># yielding final cluster points</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">projs</span> <span class="o">+</span> <span class="n">orth_vecs</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">return</span> <span class="n">points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.clusizes" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clusizes</span>


<a href="#pyclugen.clusizes" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clusizes</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Determine cluster sizes, i.e., the number of points in each cluster.</p>
<p>Cluster sizes are determined using the normal distribution (
<span class="arithmatex">\(\mu=\)</span><code>num_points</code> <span class="arithmatex">\(/\)</span><code>num_clusters</code>, <span class="arithmatex">\(\sigma=\mu/3\)</span>), and then
assuring that the final cluster sizes add up to <code>num_points</code> via the
<a class="autorefs autorefs-internal" href="#pyclugen.fix_num_points"><code>fix_num_points()</code></a> function.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">clusizes</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">sizes</span> <span class="o">=</span> <span class="n">clusizes</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">sizes</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">array([166, 217, 354, 263])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">1000</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_clusters</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>num_points</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_empty</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Allow empty clusters?</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in each cluster (vector of size <code>num_clusters</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="k">def</span> <span class="nf">clusizes</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine cluster sizes, i.e., the number of points in each cluster.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Cluster sizes are determined using the normal distribution (</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    $\mu=$`num_points` $/$`num_clusters`, $\sigma=\mu/3$), and then</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    assuring that the final cluster sizes add up to `num_points` via the</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    [`fix_num_points()`][pyclugen.helper.fix_num_points] function.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import clusizes</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(PCG64(123))</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        &gt;&gt;&gt; sizes = clusizes(4, 1000, True, rng=prng)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &gt;&gt;&gt; sizes</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        array([166, 217, 354, 263])</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &gt;&gt;&gt; sum(sizes)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        1000</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">      num_clusters: Number of clusters.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">      num_points: Total number of points.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">      allow_empty: Allow empty clusters?</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">      Number of points in each cluster (vector of size `num_clusters`).</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="c1"># Determine number of points in each cluster using the normal distribution</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="c1"># Consider the mean an equal division of points between clusters</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">num_points</span> <span class="o">/</span> <span class="n">num_clusters</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="c1"># The standard deviation is such that the interval [0, 2 * mean] will contain</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="c1"># ≈99.7% of cluster sizes</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">std</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">/</span> <span class="mi">3</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="c1"># Determine points with the normal distribution</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">clu_num_points</span> <span class="o">=</span> <span class="n">std</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">)</span> <span class="o">+</span> <span class="n">mean</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="c1"># Set negative values to zero</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">clu_num_points</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">clu_num_points</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">clu_num_points</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="c1"># Fix imbalances, so that num_points is respected</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Be careful not to divide by zero</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">clu_num_points</span> <span class="o">*=</span> <span class="n">num_points</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="c1"># Round the real values to integers since a cluster sizes is represented by</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="c1"># an integer</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">clu_num_points</span> <span class="o">=</span> <span class="n">rint</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="c1"># Make sure total points is respected, which may not be the case at this time due</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="c1"># to rounding</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">fix_num_points</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="c1"># If empty clusters are not allowed, make sure there aren&#39;t any</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_empty</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">fix_empty</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">return</span> <span class="n">clu_num_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.fix_empty" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">fix_empty</span>


<a href="#pyclugen.fix_empty" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">fix_empty</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Certifies that, given enough points, no clusters are left empty.</p>
<p>This is done by removing a point from the largest cluster and adding it to an
empty cluster while there are empty clusters. If the total number of points is
smaller than the number of clusters (or if the <code>allow_empty</code> parameter is set
to <code>true</code>), this function does nothing.</p>
<p>This function is used internally by <a class="autorefs autorefs-internal" href="#pyclugen.clusizes"><code>clusizes()</code></a>
and might be useful for custom cluster sizing implementations given as the
<code>clusizes_fn</code> parameter of the main <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> function.</p>
<p>Note that the array is changed in-place.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">fix_empty</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fix_empty</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([3, 3, 4, 1, 1])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="c1"># Verify that the array was changed in-place</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">array([3, 3, 4, 1, 1])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>clu_num_points</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in each cluster (vector of size <span class="arithmatex">\(c\)</span>),
where <span class="arithmatex">\(c\)</span> is the number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_empty</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Allow empty clusters?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in each cluster, after being fixed by this function (vector
of size <span class="arithmatex">\(c\)</span>, which is the same reference than <code>clu_num_points</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span> <span class="nf">fix_empty</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">allow_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Certifies that, given enough points, no clusters are left empty.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    This is done by removing a point from the largest cluster and adding it to an</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    empty cluster while there are empty clusters. If the total number of points is</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    smaller than the number of clusters (or if the `allow_empty` parameter is set</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    to `true`), this function does nothing.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    This function is used internally by [`clusizes()`][pyclugen.module.clusizes]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    and might be useful for custom cluster sizing implementations given as the</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    `clusizes_fn` parameter of the main [`clugen()`][pyclugen.main.clugen] function.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Note that the array is changed in-place.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; from numpy import array</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import fix_empty</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        &gt;&gt;&gt; clusters = array([3, 4, 5, 0, 0])</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        &gt;&gt;&gt; fix_empty(clusters)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        array([3, 3, 4, 1, 1])</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        &gt;&gt;&gt; clusters # Verify that the array was changed in-place</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        array([3, 3, 4, 1, 1])</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">      clu_num_points: Number of points in each cluster (vector of size $c$),</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        where $c$ is the number of clusters.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">      allow_empty: Allow empty clusters?</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">      Number of points in each cluster, after being fixed by this function (vector</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        of size $c$, which is the same reference than `clu_num_points`).</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># If the allow_empty parameter is set to true, don&#39;t do anything and return</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="c1"># immediately; this is useful for quick `clusizes_fn` one-liners</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_empty</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="c1"># Find empty clusters</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">empty_clusts</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="c1"># If there are empty clusters and enough points for all clusters...</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_clusts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">clu_num_points</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="c1"># Go through the empty clusters...</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="n">empty_clusts</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="c1"># ...get a point from the largest cluster and assign it to the</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="c1"># current empty cluster</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="n">imax</span> <span class="o">=</span> <span class="n">argmax</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="n">clu_num_points</span><span class="p">[</span><span class="n">imax</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="n">clu_num_points</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">return</span> <span class="n">clu_num_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.fix_num_points" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">fix_num_points</span>


<a href="#pyclugen.fix_num_points" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">fix_num_points</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Certifies that the values in the <code>clu_num_points</code> array add up to <code>num_points</code>.</p>
<p>If this is not the case, the <code>clu_num_points</code> array is modified in-place,
incrementing the value corresponding to the smallest cluster while
<code>sum(clu_num_points) &lt; num_points</code>, or decrementing the value corresponding to
the largest cluster while <code>sum(clu_num_points) &gt; num_points</code>.</p>
<p>This function is used internally by <a class="autorefs autorefs-internal" href="#pyclugen.clusizes"><code>clusizes()</code></a>
and might be useful for custom cluster sizing implementations given as the
<code>clusizes_fn</code> parameter of the main <a class="autorefs autorefs-internal" href="#pyclugen.clugen"><code>clugen()</code></a> function.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">fix_num_points</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># 10 total points</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fix_num_points</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1"># But we want 12 total points</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([3, 6, 3])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="c1"># Verify that the array was changed in-place</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">array([3, 6, 3])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>clu_num_points</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in each cluster (vector of size <span class="arithmatex">\(c\)</span>),
where <span class="arithmatex">\(c\)</span> is the number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>num_points</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expected total number of points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in each cluster, after being fixed by this function (vector
of size <span class="arithmatex">\(c\)</span>, which is the same reference than <code>clu_num_points</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="k">def</span> <span class="nf">fix_num_points</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Certifies that the values in the `clu_num_points` array add up to `num_points`.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    If this is not the case, the `clu_num_points` array is modified in-place,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    incrementing the value corresponding to the smallest cluster while</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    `sum(clu_num_points) &lt; num_points`, or decrementing the value corresponding to</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    the largest cluster while `sum(clu_num_points) &gt; num_points`.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    This function is used internally by [`clusizes()`][pyclugen.module.clusizes]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    and might be useful for custom cluster sizing implementations given as the</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    `clusizes_fn` parameter of the main [`clugen()`][pyclugen.main.clugen] function.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; from numpy import array</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import fix_num_points</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; clusters = array([1, 6, 3])  # 10 total points</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &gt;&gt;&gt; fix_num_points(clusters, 12) # But we want 12 total points</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        array([3, 6, 3])</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &gt;&gt;&gt; clusters # Verify that the array was changed in-place</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        array([3, 6, 3])</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">      clu_num_points: Number of points in each cluster (vector of size $c$),</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        where $c$ is the number of clusters.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">      num_points: The expected total number of points.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">      Number of points in each cluster, after being fixed by this function (vector</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        of size $c$, which is the same reference than `clu_num_points`).</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">while</span> <span class="nb">sum</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_points</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">imin</span> <span class="o">=</span> <span class="n">argmin</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">clu_num_points</span><span class="p">[</span><span class="n">imin</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">while</span> <span class="nb">sum</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_points</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">imax</span> <span class="o">=</span> <span class="n">argmax</span><span class="p">(</span><span class="n">clu_num_points</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">clu_num_points</span><span class="p">[</span><span class="n">imax</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">return</span> <span class="n">clu_num_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.llengths" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">llengths</span>


<a href="#pyclugen.llengths" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">llengths</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">llength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">llength_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Determine length of cluster-supporting lines.</p>
<p>Line lengths are determined using the folded normal distribution (
<span class="arithmatex">\(\mu=\)</span><code>llength</code>, <span class="arithmatex">\(\sigma=\)</span><code>llength_disp</code>).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">MT19937</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">llengths</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">MT19937</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">llengths</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([19.50968733, 19.92482858, 25.99013804, 18.58029672])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_clusters</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clusters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>llength</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average line length.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>llength_disp</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line length dispersion.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lengths of cluster-supporting lines (vector of size <code>num_clusters</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/module.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="k">def</span> <span class="nf">llengths</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="n">num_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">llength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">llength_disp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine length of cluster-supporting lines.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    Line lengths are determined using the folded normal distribution (</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    $\mu=$`llength`, $\sigma=$`llength_disp`).</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, MT19937</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import llengths</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        &gt;&gt;&gt; prng = Generator(MT19937(123))</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        &gt;&gt;&gt; llengths(4, 20, 3.5, rng=prng)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        array([19.50968733, 19.92482858, 25.99013804, 18.58029672])</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">      num_clusters: Number of clusters.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">      llength: Average line length.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">      llength_disp: Line length dispersion.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">      Lengths of cluster-supporting lines (vector of size `num_clusters`).</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">llength</span> <span class="o">+</span> <span class="n">llength_disp</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.points_on_line" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">points_on_line</span>


<a href="#pyclugen.points_on_line" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">points_on_line</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">dist_center</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Determine coordinates of points on a line.</p>
<p>Determine coordinates of points on a line with <code>center</code> and <code>direction</code>,
based on the distances from the center given in <code>dist_center</code>.</p>
<p>This works by using the vector formulation of the line equation assuming
<code>direction</code> is a <span class="arithmatex">\(n\)</span>-dimensional unit vector. In other words, considering
<span class="arithmatex">\(\mathbf{d}=\)</span><code>direction.reshape(-1,1)</code> ( <span class="arithmatex">\(n \times 1\)</span> vector),
<span class="arithmatex">\(\mathbf{c}=\)</span><code>center.reshape(-1,1)</code> ( <span class="arithmatex">\(n \times 1\)</span> vector), and
<span class="arithmatex">\(\mathbf{w}=\)</span> <code>dist_center.reshape(-1,1)</code> ( <span class="arithmatex">\(p \times 1\)</span> vector),
the coordinates of points on the line are given by:</p>
<div class="arithmatex">\[
\mathbf{P}=\mathbf{1}\,\mathbf{c}^T + \mathbf{w}\mathbf{d}^T
\]</div>
<p>where <span class="arithmatex">\(\mathbf{P}\)</span> is the <span class="arithmatex">\(p \times n\)</span> matrix of point coordinates on the
line, and <span class="arithmatex">\(\mathbf{1}\)</span> is a <span class="arithmatex">\(p \times 1\)</span> vector with all entries equal to 1.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">points_on_line</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">linspace</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">points_on_line</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">]),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>               <span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>               <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="c1"># 2D, 5 points</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">array([[1., 5.],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">       [3., 5.],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">       [5., 5.],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">       [7., 5.],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">       [9., 5.]])</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">points_on_line</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>               <span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>               <span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]))</span> <span class="c1"># 4D, 2 points</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">array([[ -2.,   0., -10.,   2.],</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">       [ -2.,   0.,  10.,   2.]])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>center</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center of the line ( <span class="arithmatex">\(n\)</span>-component vector).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>direction</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line direction ( <span class="arithmatex">\(n\)</span>-component unit vector).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dist_center</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance of each point to the center of the line
( <span class="arithmatex">\(p\)</span>-component vector, where <span class="arithmatex">\(p\)</span> is the number of points).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinates of points on the specified line ( <span class="arithmatex">\(p \times n\)</span> matrix).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span> <span class="nf">points_on_line</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">dist_center</span><span class="p">:</span> <span class="n">NDArray</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine coordinates of points on a line.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Determine coordinates of points on a line with `center` and `direction`,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    based on the distances from the center given in `dist_center`.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This works by using the vector formulation of the line equation assuming</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    `direction` is a $n$-dimensional unit vector. In other words, considering</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    $\mathbf{d}=$`direction.reshape(-1,1)` ( $n \times 1$ vector),</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    $\mathbf{c}=$`center.reshape(-1,1)` ( $n \times 1$ vector), and</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    $\mathbf{w}=$ `dist_center.reshape(-1,1)` ( $p \times 1$ vector),</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    the coordinates of points on the line are given by:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    $$</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    \mathbf{P}=\mathbf{1}\,\mathbf{c}^T + \mathbf{w}\mathbf{d}^T</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    $$</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    where $\mathbf{P}$ is the $p \times n$ matrix of point coordinates on the</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    line, and $\mathbf{1}$ is a $p \times 1$ vector with all entries equal to 1.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import points_on_line</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        &gt;&gt;&gt; from numpy import array, linspace</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; points_on_line(array([5., 5.]),</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        ...                array([1., 0.]),</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        ...                linspace(-4, 4, 5)) # 2D, 5 points</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        array([[1., 5.],</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">               [3., 5.],</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">               [5., 5.],</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">               [7., 5.],</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">               [9., 5.]])</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        &gt;&gt;&gt; points_on_line(array([-2, 0, 0., 2]),</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        ...                array([0., 0, -1, 0]),</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        ...                array([10, -10])) # 4D, 2 points</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        array([[ -2.,   0., -10.,   2.],</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">               [ -2.,   0.,  10.,   2.]])</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">      center: Center of the line ( $n$-component vector).</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">      direction: Line direction ( $n$-component unit vector).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">      dist_center: Distance of each point to the center of the line</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        ( $p$-component vector, where $p$ is the number of points).</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">      Coordinates of points on the specified line ( $p \times n$ matrix).</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">return</span> <span class="n">center</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">dist_center</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">direction</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.rand_ortho_vector" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rand_ortho_vector</span>


<a href="#pyclugen.rand_ortho_vector" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rand_ortho_vector</span><span class="p">(</span><span class="n">u</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get a random unit vector orthogonal to <code>u</code>.</p>
<p>Note that <code>u</code> is expected to be a unit vector itself.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">rand_ortho_vector</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">isclose</span><span class="p">,</span> <span class="n">dot</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Get a random vector with 3 components (3D)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c1"># Normalize it</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">r_ort</span> <span class="o">=</span> <span class="n">rand_ortho_vector</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span> <span class="c1"># Get random unit vector orth. to r</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">r_ort</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">array([-0.1982903 , -0.61401512,  0.76398062])</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">isclose</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_ort</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Check that vectors are indeed orthogonal</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">True</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>u</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit vector with <span class="arithmatex">\(n\)</span> components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random unit vector with <span class="arithmatex">\(n\)</span> components orthogonal to <code>u</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span> <span class="nf">rand_ortho_vector</span><span class="p">(</span><span class="n">u</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a random unit vector orthogonal to `u`.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Note that `u` is expected to be a unit vector itself.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import rand_ortho_vector</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        &gt;&gt;&gt; from numpy import isclose, dot</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        &gt;&gt;&gt; from numpy.linalg import norm</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        &gt;&gt;&gt; rng = Generator(PCG64(123))</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        &gt;&gt;&gt; r = rng.random(3) # Get a random vector with 3 components (3D)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; r = r / norm(r) # Normalize it</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; r_ort = rand_ortho_vector(r, rng=rng) # Get random unit vector orth. to r</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; r_ort</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        array([-0.1982903 , -0.61401512,  0.76398062])</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; isclose(dot(r, r_ort), 0) # Check that vectors are indeed orthogonal</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        True</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">      u: Unit vector with $n$ components.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">      A random unit vector with $n$ components orthogonal to `u`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># If 1D, just return a random unit vector</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="k">return</span> <span class="n">rand_unit_vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="c1"># Find a random, non-parallel vector to u</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="c1"># Find normalized random vector</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">rand_unit_vector</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="c1"># If not parallel to u we can keep it and break the loop</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">isclose</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r</span><span class="p">)),</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="k">break</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="c1"># Get vector orthogonal to u using 1st iteration of Gram-Schmidt process</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="c1"># Normalize it</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1"># And return it</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.rand_unit_vector" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rand_unit_vector</span>


<a href="#pyclugen.rand_unit_vector" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rand_unit_vector</span><span class="p">(</span><span class="n">num_dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get a random unit vector with <code>num_dims</code> components.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">rand_unit_vector</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rand_unit_vector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">array([ 0.48653889,  0.50753862,  0.05711487, -0.70881757])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">rand_unit_vector</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rand_unit_vector</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span> <span class="c1"># Reproducible</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([ 0.3783202 , -0.92567479])</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_dims</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of components in vector (i.e. vector size).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random unit vector with <code>num_dims</code> components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">def</span> <span class="nf">rand_unit_vector</span><span class="p">(</span><span class="n">num_dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a random unit vector with `num_dims` components.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import rand_unit_vector</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        &gt;&gt;&gt; rand_unit_vector(4) # doctest: +SKIP</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        array([ 0.48653889,  0.50753862,  0.05711487, -0.70881757])</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import rand_unit_vector</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &gt;&gt;&gt; rng = Generator(PCG64(123))</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; rand_unit_vector(2, rng=rng) # Reproducible</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        array([ 0.3783202 , -0.92567479])</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">      num_dims: Number of components in vector (i.e. vector size).</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">      A random unit vector with `num_dims` components.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">return</span> <span class="n">r</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyclugen.rand_vector_at_angle" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rand_vector_at_angle</span>


<a href="#pyclugen.rand_vector_at_angle" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rand_vector_at_angle</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">u</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get a random unit vector which is at <code>angle</code> radians of vector <code>u</code>.</p>
<p>Note that <code>u</code> is expected to be a unit vector itself.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyclugen</span> <span class="kn">import</span> <span class="n">rand_vector_at_angle</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arccos</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">dot</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">])</span> <span class="c1"># Define a 4D vector</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="c1"># Normalize the vector</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">rand_vector_at_angle</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span> <span class="c1"># Get a vector at 45 degrees</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">array([ 0.633066  , -0.50953554, -0.10693823, -0.57285705])</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">degrees</span><span class="p">(</span><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span> <span class="c1"># Angle between u and v</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">45.0</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>u</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit vector with <span class="arithmatex">\(n\)</span> components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>angle</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Angle in radians.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rng</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.random.Generator" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator">Generator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pseudo-random number generator.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyclugen.shared._default_rng">_default_rng</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.typing.NDArray" href="https://numpy.org/doc/stable/reference/typing.html#numpy.typing.NDArray">NDArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random unit vector with <span class="arithmatex">\(n\)</span> components which is at <code>angle</code> radians
with vector <code>u</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyclugen/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="k">def</span> <span class="nf">rand_vector_at_angle</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">u</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="n">_default_rng</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a random unit vector which is at `angle` radians of vector `u`.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Note that `u` is expected to be a unit vector itself.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        &gt;&gt;&gt; from pyclugen import rand_vector_at_angle</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        &gt;&gt;&gt; from numpy import arccos, array, degrees, pi, dot</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &gt;&gt;&gt; from numpy.linalg import norm</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &gt;&gt;&gt; from numpy.random import Generator, PCG64</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        &gt;&gt;&gt; rng = Generator(PCG64(123))</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        &gt;&gt;&gt; u = array([ 1.0, 0, 0.5, -0.5 ]) # Define a 4D vector</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        &gt;&gt;&gt; u = u / norm(u) # Normalize the vector</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &gt;&gt;&gt; v = rand_vector_at_angle(u, pi/4, rng=rng) # Get a vector at 45 degrees</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        &gt;&gt;&gt; v</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        array([ 0.633066  , -0.50953554, -0.10693823, -0.57285705])</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        &gt;&gt;&gt; degrees(arccos(dot(u, v) / norm(u) * norm(v))) # Angle between u and v</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        45.0</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">      u: Unit vector with $n$ components.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">      angle: Angle in radians.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">      rng: Optional pseudo-random number generator.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">      Random unit vector with $n$ components which is at `angle` radians</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        with vector `u`.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">u</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="k">return</span> <span class="n">rand_ortho_vector</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">elif</span> <span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">u</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">rand_ortho_vector</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="k">return</span> <span class="n">v</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># For |θ| &gt; π/2 or the 1D case, simply return a random vector</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="n">rand_unit_vector</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="CC-BY License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
  
  
    Made with
    <a
      href="https://www.mkdocs.org/"
      target="_blank" rel="noopener"
    >
      MkDocs
    </a>,
    <a
      href="https://mkdocstrings.github.io/"
      target="_blank" rel="noopener"
    >
      mkdocstrings
    </a>,
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a> and
    <a
      href="https://smarie.github.io/mkdocs-gallery/"
      target="_blank" rel="noopener"
    >
      MkDocs Gallery
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.expand", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>